{% extends 'base.html.twig' %}

{% block title %}Fitness & Meal Plan Generator - Your Personal Health Assistant{% endblock %}

{% block body %}
    <div class="welcome-container">
        <!-- Hero Section -->
        <div class="hero-section text-center py-5 mb-5 rounded-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <div class="container">
                <h1 class="display-4 fw-bold text-white mb-3 animate__animated animate__fadeInDown">
                    <i class="fas fa-heartbeat me-3"></i>Welcome to FitLife Pro
                </h1>
                <p class="lead text-light mb-4 animate__animated animate__fadeInUp">
                    Your all-in-one solution for personalized fitness and nutrition planning
                </p>
                <div class="hero-animation">
                    <i class="fas fa-apple-alt fa-3x text-white me-4 animate__animated animate__bounce"></i>
                    <i class="fas fa-dumbbell fa-3x text-white me-4 animate__animated animate__pulse"></i>
                    <i class="fas fa-chart-line fa-3x text-white animate__animated animate__swing"></i>
                </div>
            </div>
        </div>

        <div class="container">
            <!-- User Dashboard (Logged In) -->
            {% if app.user %}
                <div class="row mb-5">
                    <div class="col-lg-8 mx-auto">
                        <div class="dashboard-card card border-0 shadow-lg rounded-4 overflow-hidden animate__animated animate__zoomIn">
                            <div class="card-header bg-gradient-primary text-white py-4">
                                <div class="d-flex align-items-center">
                                    <div class="avatar-circle bg-white text-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 60px; height: 60px;">
                                        <i class="fas fa-user fa-2x"></i>
                                    </div>
                                    <div>
                                        <h3 class="mb-1">Welcome back, {{ app.user.name }}! üëã</h3>
                                        <p class="mb-0 opacity-75">Ready for today's fitness journey?</p>
                                    </div>
                                </div>
                            </div>

                            <div class="card-body p-4">
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <div class="stats-card p-3 rounded-3 bg-light-blue">
                                            <div class="d-flex align-items-center">
                                                <div class="icon-circle bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 50px; height: 50px;">
                                                    <i class="fas fa-user fa-lg"></i>
                                                </div>
                                                <div>
                                                    <h6 class="mb-0 text-muted">Age</h6>
                                                    <h4 class="mb-0 fw-bold">{{ app.user.age ?? 'Not set' }}</h4>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-6 mb-4">
                                        <div class="stats-card p-3 rounded-3 bg-light-green">
                                            <div class="d-flex align-items-center">
                                                <div class="icon-circle bg-success text-white rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 50px; height: 50px;">
                                                    <i class="fas fa-weight fa-lg"></i>
                                                </div>
                                                <div>
                                                    <h6 class="mb-0 text-muted">Weight</h6>
                                                    <h4 class="mb-0 fw-bold">{{ app.user.weight ?? 'Not set' }} kg</h4>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-12 mb-4">
                                        <div class="stats-card p-3 rounded-3 bg-light-purple">
                                            <div class="d-flex align-items-center">
                                                <div class="icon-circle bg-purple text-white rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 50px; height: 50px;">
                                                    <i class="fas fa-bullseye fa-lg"></i>
                                                </div>
                                                <div>
                                                    <h6 class="mb-0 text-muted">Fitness Goal</h6>
                                                    <h4 class="mb-0 fw-bold">
                                                        {% if app.user.goal == 'weight_loss' %}
                                                            <span class="badge bg-danger">Weight Loss</span>
                                                        {% elseif app.user.goal == 'muscle_gain' %}
                                                            <span class="badge bg-warning">Muscle Gain</span>
                                                        {% elseif app.user.goal == 'maintain' %}
                                                            <span class="badge bg-info">Maintain Weight</span>
                                                        {% elseif app.user.goal == 'improve_fitness' %}
                                                            <span class="badge bg-success">Improve Fitness</span>
                                                        {% else %}
                                                            <span class="badge bg-secondary">Not set</span>
                                                        {% endif %}
                                                    </h4>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="action-buttons text-center mt-4">
                                    <a href="{{ path('app_meal_plan_generate') }}" class="btn btn-primary btn-lg px-5 py-3 me-3 rounded-pill shadow-sm">
                                        <i class="fas fa-utensils me-2"></i>Generate Meal Plan
                                    </a>
                                    <a href="{{ path('app_progress_new') }}" class="btn btn-success btn-lg px-5 py-3 rounded-pill shadow-sm">
                                        <i class="fas fa-chart-line me-2"></i>Log Progress
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% else %}
                <!-- Welcome for Guests -->
                <div class="row mb-5">
                    <div class="col-lg-8 mx-auto">
                        <div class="welcome-card card border-0 shadow-lg rounded-4 overflow-hidden animate__animated animate__fadeInUp">
                            <div class="card-body p-5 text-center">
                                <div class="emoji-display mb-4">
                                    <span class="emoji">üçé</span>
                                    <span class="emoji">üí™</span>
                                    <span class="emoji">ü•ó</span>
                                    <span class="emoji">üèÉ‚Äç‚ôÇÔ∏è</span>
                                    <span class="emoji">üìä</span>
                                </div>

                                <h2 class="fw-bold text-gradient mb-3">Start Your Fitness Journey Today! üåü</h2>
                                <p class="lead mb-4">
                                    Join thousands of users who are transforming their lives with personalized fitness and nutrition plans.
                                </p>

                                <div class="cta-buttons">
                                    <a href="{{ path('app_register') }}" class="btn btn-primary btn-lg px-5 py-3 me-3 rounded-pill shadow-sm animate__animated animate__pulse animate__infinite">
                                        <i class="fas fa-rocket me-2"></i>Get Started Free
                                    </a>
                                    <a href="{{ path('app_login') }}" class="btn btn-outline-primary btn-lg px-5 py-3 rounded-pill">
                                        <i class="fas fa-sign-in-alt me-2"></i>Login
                                    </a>
                                </div>

                                <div class="mt-4">
                                    <small class="text-muted">
                                        <i class="fas fa-shield-alt me-1"></i>Secure & Private ‚Ä¢
                                        <i class="fas fa-smile me-1"></i>Easy to Use ‚Ä¢
                                        <i class="fas fa-mobile-alt me-1"></i>Mobile Friendly
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}

            <!-- Features Section -->
            <div class="features-section mb-5">
                <h2 class="text-center fw-bold mb-5 text-gradient">Amazing Features ‚ú®</h2>

                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="feature-card card h-100 border-0 shadow-sm rounded-4 hover-lift">
                            <div class="card-body p-4 text-center">
                                <div class="feature-icon mb-3">
                                    <div class="icon-circle bg-gradient-blue text-white rounded-circle d-inline-flex align-items-center justify-content-center" style="width: 70px; height: 70px;">
                                        <i class="fas fa-utensils fa-2x"></i>
                                    </div>
                                </div>
                                <h4 class="fw-bold mb-3">Personalized Meal Plans üçΩÔ∏è</h4>
                                <p class="text-muted">Customized nutrition plans based on your goals, preferences, and dietary restrictions.</p>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="feature-card card h-100 border-0 shadow-sm rounded-4 hover-lift">
                            <div class="card-body p-4 text-center">
                                <div class="feature-icon mb-3">
                                    <div class="icon-circle bg-gradient-green text-white rounded-circle d-inline-flex align-items-center justify-content-center" style="width: 70px; height: 70px;">
                                        <i class="fas fa-dumbbell fa-2x"></i>
                                    </div>
                                </div>
                                <h4 class="fw-bold mb-3">Workout Library üí™</h4>
                                <p class="text-muted">Access hundreds of exercises and workout routines for all fitness levels.</p>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="feature-card card h-100 border-0 shadow-sm rounded-4 hover-lift">
                            <div class="card-body p-4 text-center">
                                <div class="feature-icon mb-3">
                                    <div class="icon-circle bg-gradient-purple text-white rounded-circle d-inline-flex align-items-center justify-content-center" style="width: 70px; height: 70px;">
                                        <i class="fas fa-chart-line fa-2x"></i>
                                    </div>
                                </div>
                                <h4 class="fw-bold mb-3">Progress Tracking üìä</h4>
                                <p class="text-muted">Track your weight, measurements, and photos to visualize your transformation.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row g-4 mt-4">
                    <div class="col-md-6">
                        <div class="feature-card card h-100 border-0 shadow-sm rounded-4 hover-lift">
                            <div class="card-body p-4 text-center">
                                <div class="feature-icon mb-3">
                                    <div class="icon-circle bg-gradient-orange text-white rounded-circle d-inline-flex align-items-center justify-content-center" style="width: 70px; height: 70px;">
                                        <i class="fas fa-calculator fa-2x"></i>
                                    </div>
                                </div>
                                <h4 class="fw-bold mb-3">Calorie Calculator üßÆ</h4>
                                <p class="text-muted">Smart calorie calculation integrated directly into your meal plan generation.</p>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="feature-card card h-100 border-0 shadow-sm rounded-4 hover-lift">
                            <div class="card-body p-4 text-center">
                                <div class="feature-icon mb-3">
                                    <div class="icon-circle bg-gradient-pink text-white rounded-circle d-inline-flex align-items-center justify-content-center" style="width: 70px; height: 70px;">
                                        <i class="fas fa-file-pdf fa-2x"></i>
                                    </div>
                                </div>
                                <h4 class="fw-bold mb-3">PDF Export üìÑ</h4>
                                <p class="text-muted">Download your meal plans as beautiful PDFs to take with you anywhere.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stats Counter -->
            <div class="stats-section py-5 mb-5 rounded-4" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                <div class="row text-center">
                    <div class="col-md-3 mb-4 mb-md-0">
                        <div class="stat-item">
                            <h2 class="display-4 fw-bold text-white" data-count="1000">0</h2>
                            <p class="text-light mb-0">Active Users</p>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4 mb-md-0">
                        <div class="stat-item">
                            <h2 class="display-4 fw-bold text-white" data-count="500">0</h2>
                            <p class="text-light mb-0">Meal Plans</p>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4 mb-md-0">
                        <div class="stat-item">
                            <h2 class="display-4 fw-bold text-white" data-count="200">0</h2>
                            <p class="text-light mb-0">Workouts</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-item">
                            <h2 class="display-4 fw-bold text-white" data-count="99">0</h2>
                            <p class="text-light mb-0">% Satisfaction</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Testimonial -->
            <div class="testimonial-section mb-5">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="testimonial-card card border-0 shadow rounded-4">
                            <div class="card-body p-4">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="testimonial-avatar rounded-circle overflow-hidden me-3" style="width: 60px; height: 60px;">
                                        <img src="https://ui-avatars.com/api/?name=Sarah+Johnson&background=random&color=fff" alt="Sarah Johnson" class="w-100 h-100">
                                    </div>
                                    <div>
                                        <h5 class="fw-bold mb-0">Sarah Johnson</h5>
                                        <p class="text-muted mb-0">Lost 15kg with FitLife</p>
                                    </div>
                                    <div class="ms-auto">
                                        <i class="fas fa-quote-right fa-2x text-primary opacity-25"></i>
                                    </div>
                                </div>
                                <p class="lead mb-0">
                                    <i class="fas fa-quote-left text-primary me-2"></i>
                                    This platform changed my life! The personalized meal plans and workout routines made fitness enjoyable and effective. I've never felt better!
                                    <i class="fas fa-quote-right text-primary ms-2"></i>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Elements -->
    <div class="floating-elements">
        <div class="float-element float-1"><i class="fas fa-apple-alt"></i></div>
        <div class="float-element float-2"><i class="fas fa-dumbbell"></i></div>
        <div class="float-element float-3"><i class="fas fa-heart"></i></div>
        <div class="float-element float-4"><i class="fas fa-running"></i></div>
    </div>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .welcome-container {
            position: relative;
            overflow: hidden;
        }

        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.1" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,160C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') no-repeat bottom;
            background-size: cover;
        }

        .text-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .emoji {
            font-size: 2.5rem;
            margin: 0 0.5rem;
            display: inline-block;
            animation: bounce 2s infinite;
        }

        .emoji:nth-child(2) { animation-delay: 0.2s; }
        .emoji:nth-child(3) { animation-delay: 0.4s; }
        .emoji:nth-child(4) { animation-delay: 0.6s; }
        .emoji:nth-child(5) { animation-delay: 0.8s; }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .feature-card {
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            border-color: #667eea;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2) !important;
        }

        .icon-circle {
            transition: all 0.3s ease;
        }

        .feature-card:hover .icon-circle {
            transform: scale(1.1) rotate(5deg);
        }

        .bg-gradient-blue {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .bg-gradient-green {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .bg-gradient-purple {
            background: linear-gradient(135deg, #8a2387 0%, #f27121 100%);
        }

        .bg-gradient-orange {
            background: linear-gradient(135deg, #f12711 0%, #f5af19 100%);
        }

        .bg-gradient-pink {
            background: linear-gradient(135deg, #ec008c 0%, #fc6767 100%);
        }

        .bg-light-blue { background-color: #e3f2fd; }
        .bg-light-green { background-color: #e8f5e9; }
        .bg-light-purple { background-color: #f3e5f5; }

        .stats-section {
            position: relative;
            overflow: hidden;
        }

        .stats-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.1" d="M0,224L48,218.7C96,213,192,203,288,213.3C384,224,480,256,576,250.7C672,245,768,203,864,186.7C960,171,1056,181,1152,176C1248,171,1344,149,1392,138.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') no-repeat bottom;
            background-size: cover;
        }

        .testimonial-card {
            background: white;
            position: relative;
        }

        .testimonial-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px 4px 0 0;
        }

        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .float-element {
            position: absolute;
            font-size: 2rem;
            opacity: 0.1;
            animation: float 20s infinite linear;
        }

        .float-1 { top: 10%; left: 5%; animation-delay: 0s; }
        .float-2 { top: 20%; right: 10%; animation-delay: 5s; }
        .float-3 { bottom: 30%; left: 15%; animation-delay: 10s; }
        .float-4 { bottom: 20%; right: 5%; animation-delay: 15s; }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
            100% { transform: translateY(0) rotate(360deg); }
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .rounded-4 {
            border-radius: 1rem !important;
        }

        .rounded-5 {
            border-radius: 1.5rem !important;
        }

        .hover-lift {
            transition: transform 0.3s ease;
        }

        .hover-lift:hover {
            transform: translateY(-5px);
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .display-4 {
                font-size: 2.5rem;
            }

            .btn-lg {
                padding: 0.75rem 1.5rem;
                font-size: 1rem;
            }

            .emoji {
                font-size: 1.8rem;
            }
        }
    </style>

    <script>
        // Animate counters
        document.addEventListener('DOMContentLoaded', function() {
            // Counter animation
            const counters = document.querySelectorAll('.stat-item h2');
            counters.forEach(counter => {
                const target = parseInt(counter.getAttribute('data-count'));
                const increment = target / 200;
                let current = 0;

                const updateCounter = () => {
                    if (current < target) {
                        current += increment;
                        counter.textContent = Math.floor(current);
                        setTimeout(updateCounter, 10);
                    } else {
                        counter.textContent = target;
                    }
                };

                // Start counter when in viewport
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            updateCounter();
                            observer.unobserve(entry.target);
                        }
                    });
                });

                observer.observe(counter);
            });

            // Random emoji animation
            const emojis = ['üçé', 'üí™', 'ü•ó', 'üèÉ‚Äç‚ôÇÔ∏è', 'üìä', '‚ú®', 'üåü', 'üî•', 'üíñ', 'üèãÔ∏è‚Äç‚ôÄÔ∏è'];
            const emojiContainers = document.querySelectorAll('.emoji');

            setInterval(() => {
                emojiContainers.forEach(container => {
                    if (Math.random() > 0.7) { // 30% chance to change
                        const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];
                        container.textContent = randomEmoji;
                        container.style.transform = 'scale(1.2)';
                        setTimeout(() => {
                            container.style.transform = 'scale(1)';
                        }, 200);
                    }
                });
            }, 3000);

            // Add confetti effect on CTA button click
            document.querySelector('.btn-primary.animate__pulse')?.addEventListener('click', function(e) {
                if (!this.classList.contains('confetti-fired')) {
                    this.classList.add('confetti-fired');
                    createConfetti();
                }
            });

            function createConfetti() {
                const colors = ['#667eea', '#764ba2', '#11998e', '#38ef7d', '#f12711', '#f5af19'];
                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.style.cssText = `
                    position: fixed;
                    width: 10px;
                    height: 10px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    border-radius: 50%;
                    top: 50%;
                    left: 50%;
                    pointer-events: none;
                    z-index: 1000;
                    transform: translate(-50%, -50%);
                    animation: confetti-fall ${Math.random() * 1 + 1}s linear forwards;
                `;

                    const keyframes = `
                    @keyframes confetti-fall {
                        0% {
                            transform: translate(-50%, -50%) rotate(0deg);
                            opacity: 1;
                        }
                        100% {
                            transform: translate(${Math.random() * 200 - 100}px, 100vh) rotate(${Math.random() * 360}deg);
                            opacity: 0;
                        }
                    }
                `;

                    const style = document.createElement('style');
                    style.textContent = keyframes;
                    document.head.appendChild(style);

                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 2000);
                }
            }
        });
    </script>
{% endblock %}
